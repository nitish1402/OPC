#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int check_authentication(char *password) 
{
   //char password_buffer[16];
   int auth_flag = 0;
   char hack='a';
   int auth_flag1=9;
      char password_buffer[16];

   printf("[BEFORE] password_buffer is at %p and contains \'%s\'\n",password_buffer,password_buffer);
   printf("[BEFORE] auth_flag is at %p and contains %d which is \'%08x\'\n",&auth_flag,auth_flag,auth_flag);
   printf("[BEFORE] hack is at %p and contains %c\n",&hack,hack);
   printf("[BEFORE] auth_flag1 is at %p and contains %d which is \'%08x\'\n",&auth_flag1,auth_flag1,auth_flag1);

   printf("copying password in password buffer\n\n");
   strcpy(password_buffer, password);
   printf("[AFTER] password_buffer is at %p and contains \'%s\'\n",password_buffer,password_buffer);
   printf("[AFTER] auth_flag is at %p and contains %d which is \'%08x\'\n",&auth_flag,auth_flag,auth_flag);


   if(strcmp(password_buffer, "brillig") == 0)
       auth_flag = 1;

   if(strcmp(password_buffer, "outgrabe") == 0)
       auth_flag = 1;

   return auth_flag;
}

int main(int argc, char *argv[]) 
{
  if(argc < 2) {
  printf("Usage: %s <password>\n", argv[0]);
    exit(0);
  }
  if(check_authentication(argv[1])) {
   printf("\n-=-=-=-=-=-=-=-=-=-=-=-=-=-\n");
   printf(" Access Granted.\n");
   printf("-=-=-=-=-=-=-=-=-=-=-=-=-=-\n");
  } else {
    printf("\nAccess Denied.\n");
  }
}

